- commits:
    - subject: Update layers/meta-balena to 9431a0dcafd13d0218b875f40e7e642d042ae4aa
      hash: 21c0fe65c524e34674279dbb19fa320f03e17747
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to 9431a0dcafd13d0218b875f40e7e642d042ae4aa
        changelog-entry: Update layers/meta-balena to 9431a0dcafd13d0218b875f40e7e642d042ae4aa
      author: Renovate Bot
      nested:
        - commits:
            - subject: "linux-firmware: package QuZ-a0-jf-b0 separately"
              hash: 20695e32e0e8b3d60267090530b3cd41a3450d56
              body: |
                This is used by Intel Wireless-AC 9462
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Michal Toman <michalt@balena.io>
                signed-off-by: Michal Toman <michalt@balena.io>
              author: Michal Toman
              nested: []
          version: meta-balena-2.98.7
          title: "'linux-firmware: package QuZ-a0-jf-b0 separately'"
          date: 2022-04-27T09:22:39.188Z
  version: 2.98.7
  title: "'Update layers/meta-balena digest to 9431a0d'"
  date: 2022-04-27T17:42:56.213Z
- commits:
    - subject: Update layers/meta-balena to 798e236d25380d70e7be09d8d5dbb0349c05f413
      hash: 4a0efa4290653516d2e9a3e0e27971a3e0cef8d8
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to 798e236d25380d70e7be09d8d5dbb0349c05f413
        changelog-entry: Update layers/meta-balena to 798e236d25380d70e7be09d8d5dbb0349c05f413
      author: Renovate Bot
      nested:
        - commits:
            - subject: "timeinit/timesync-https: Update rtc after setting system time"
              hash: f16451b49b77bd7d3f5f82d20e0605a9797832eb
              body: >
                This solves a problem seen on a device on which, although

                timeinit-rtc finishes running before timesync-https, chronyd

                sets the system time to the incorrect rtc time

                as soon as timesync-https finished running and setting the correct date

                from the servers.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alexandru Costache <alexandru@balena.io>
                signed-off-by: Alexandru Costache <alexandru@balena.io>
              author: Alexandru Costache
              nested: []
          version: meta-balena-2.98.6
          title: "'timeinit/timesync-https: Update rtc after setting system time'"
          date: 2022-04-26T19:32:46.066Z
  version: 2.98.6
  title: "'Update layers/meta-balena digest to 798e236'"
  date: 2022-04-27T11:51:47.116Z
- commits:
    - subject: Update layers/meta-balena to edda207aee705431cd02443bdfe8d6271228b96d
      hash: 154e7587260713559ec90c38d5582b8013f0639c
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to edda207aee705431cd02443bdfe8d6271228b96d
        changelog-entry: Update layers/meta-balena to edda207aee705431cd02443bdfe8d6271228b96d
      author: Renovate Bot
      nested:
        - commits:
            - subject: "networkmanager: Use default DHCP timeout"
              hash: 6175420731baa349c8d197151189462a23b2f460
              body: >
                This reverts 5047757 where we set the global DHCP timeout for
                ipv4 to

                infinity to mitigate problems with routers that do not respond to DHCP

                requests in time.


                This however causes issues on some routers, which after power cycle fail to

                renew leases after they are expired.


                The same ipv4.dhcp-timeout can be specified on per connection basis. Since

                the case with lease renewal due to router power cycle is a more common case,

                it is better to keep the global dhcp-timeout default unmodified. If the

                setting needs adjustment then it can be overwritten in the particular

                connection profile.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Zahari Petkov <zahari@balena.io>
                signed-off-by: Zahari Petkov <zahari@balena.io>
              author: Zahari Petkov
              nested: []
          version: meta-balena-2.98.5
          title: "'networkmanager: Use default DHCP timeout'"
          date: 2022-04-26T11:36:14.839Z
  version: 2.98.5
  title: "'Update layers/meta-balena digest to edda207'"
  date: 2022-04-26T19:07:28.535Z
- commits:
    - subject: Update balena-yocto-scripts to 13da1d2fd4483ba9a2cf9d3d7146985bbd720c6b
      hash: cd2c5380507fde43244a94e3c2c1d18451d05db0
      body: Update balena-yocto-scripts
      footer:
        Changelog-entry: Update balena-yocto-scripts to 13da1d2fd4483ba9a2cf9d3d7146985bbd720c6b
        changelog-entry: Update balena-yocto-scripts to 13da1d2fd4483ba9a2cf9d3d7146985bbd720c6b
      author: Renovate Bot
      nested:
        - commits:
            - subject: "balena-lib: fix 445d6d1fcfce97f85ffcfedc0083eb658a734321"
              hash: d8a3a47e87dc65b81451e5dd07213577cc9fe82b
              body: |
                Commit 445d6d1fcfce97f85ffcfedc0083eb658a734321 does not fix
                the issue because it is missing the --global arg without which
                the git config command fails.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Florin Sarbu <florin@balena.io>
                signed-off-by: Florin Sarbu <florin@balena.io>
              author: Florin Sarbu
              nested: []
          version: balena-yocto-scripts-1.19.3
          title: "'balena-lib: fix 445d6d1fcfce97f85ffcfedc0083eb658a734321'"
          date: 2022-04-26T08:40:52.078Z
  version: 2.98.4+rev1
  title: "'Update balena-yocto-scripts digest to 13da1d2'"
  date: 2022-04-26T12:58:29.646Z
- commits:
    - subject: Update layers/meta-balena to 0d70942b143215aa0c350705d74a71a87d42870a
      hash: db9233b4da2bea5912dff2fcd9640d76ebb9deaa
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to 0d70942b143215aa0c350705d74a71a87d42870a
        changelog-entry: Update layers/meta-balena to 0d70942b143215aa0c350705d74a71a87d42870a
      author: Renovate Bot
      nested:
        - commits:
            - subject: Disable Engine startup timeouts
              hash: c4ce541526455c8cb891e7c76889e0d4cb2735b1
              body: >
                There are known situations in which balenaEngine times out
                during

                initialization (for example, during aufs to overlayfs migrations, or

                when restarting a device that was running a large number of containers).

                When these time outs occur, Systemd kills the Engine, causing further

                problems.


                To avoid these cases, this commit disables timeouts during the Engine

                initialization.


                This is also aligned with the default Systemd settings distributed with

                the Moby project.
              footer:
                Signed-off-by: Leandro Motta Barros <leandro@balena.io>
                signed-off-by: Leandro Motta Barros <leandro@balena.io>
                Change-type: patch
                change-type: patch
              author: Leandro Motta Barros
              nested: []
          version: meta-balena-2.98.4
          title: "'Disable Engine startup timeouts'"
          date: 2022-04-25T22:36:18.725Z
  version: 2.98.4
  title: "'Update layers/meta-balena digest to 0d70942'"
  date: 2022-04-26T02:08:45.042Z
- commits:
    - subject: Update layers/meta-balena to c71a9ac922091069e6fa736a07213685555ff21c
      hash: 7222bade77d7d55968d826c2bfa4191fd53c30bb
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to c71a9ac922091069e6fa736a07213685555ff21c
        changelog-entry: Update layers/meta-balena to c71a9ac922091069e6fa736a07213685555ff21c
      author: Renovate Bot
      nested:
        - commits:
            - subject: Add renovate configuration
              hash: 2537c8eed6f50399ce60b9f2ccc22336fb7cb86a
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
          version: meta-balena-2.98.3
          title: "'Add renovate configuration'"
          date: 2022-04-25T18:07:21.534Z
        - commits:
            - subject: "balena-config-vars: unit-conf: Correct description"
              hash: b1ff3f620ea823239442cfeccd52feef6928f405
              body: |
                The os-networkmanager entry had an incorrect description.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "tests: os: Remove sshKeys test"
              hash: 579aef0199ed91f31bca301f7dc8ebd517594583
              body: >
                This is replaced by an SSH authentication test in the cloud
                suite, which

                is more comprenhensive.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "tests: cloud: Add SSH authentication tests"
              hash: e9f125a67aa61136fe36a5844ca751984ab679aa
              body: >
                This new test validates SSH authentication both in production
                and

                development mode.


                A managed device is always accessible via the configured custom keys.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "os-sshkeys: When ssh keys change, regenerate development
                configuration"
              hash: 0856b6e7acbe41a1bc60afb26906ee5bf9b253a9
              body: >
                The behaviour of the SSH connection depends on whether custom
                keys are

                present or not. This commit calls out to generate the development mode

                configuration file on ssh key change.


                Fixes #2530
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "development-features: use os-helpers-devmode include file"
              hash: afb63f9bfb794fa7af14c6e03bf29e85705dbf7f
              body: >
                The development mode configuration file is now generated on a
                helper

                script.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "os-helpers: Add os-helpers-devmode"
              hash: dfaef0b9c7d07b31f254c2f9592772a58562f9e9
              body: >
                This extracts the generation of the development mode
                configuration file

                so it can be shared.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: meta-balena-2.98.2
          title: "'Apply sshKeys change on development Mode'"
          date: 2022-04-25T08:16:24.320Z
  version: 2.98.3
  title: "'Update layers/meta-balena digest to c71a9ac'"
  date: 2022-04-25T19:39:01.800Z
- commits:
    - subject: Update layers/meta-balena to 54c754e97eb0ba3dcb4119908cc368e200c2f4ca
      hash: 90fbe07e7434ce9a62faa3463467a3b3fe7d4d41
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to 54c754e97eb0ba3dcb4119908cc368e200c2f4ca
        changelog-entry: Update layers/meta-balena to 54c754e97eb0ba3dcb4119908cc368e200c2f4ca
      author: Renovate Bot
      nested:
        - commits:
            - subject: "tests/leviathan: Update leviathan to v2.2.4"
              hash: 162c36be826eb3028a11fca2266407e8d2570d88
              body: |
                Update leviathan from 2.0.4 to 2.2.4
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
          version: meta-balena-2.98.1
          title: "'tests/leviathan: Update leviathan to v2.2.4'"
          date: 2022-04-23T18:56:56.077Z
  version: 2.98.1
  title: "'Update layers/meta-balena digest to 54c754e'"
  date: 2022-04-24T02:16:20.016Z
- commits:
    - subject: Update layers/meta-balena to 5498ce099c7316a58d21c35d970292f1e2443d97
      hash: 8af6daabe8803dae79106bcf54924d081b3d0707
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to 5498ce099c7316a58d21c35d970292f1e2443d97
        changelog-entry: Update layers/meta-balena to 5498ce099c7316a58d21c35d970292f1e2443d97
      author: Renovate Bot
      nested:
        - commits:
            - subject: Refresh PKI assets from config endpoint
              hash: 081fca887b36108bc192ee98da6ba088f9e909b9
              body: >
                * Fixes #2569

                * ensure OpenVPN client always starts with the latest CA certificate
                  from API config endpoint as this certificate may have changed and
                  we don't want VPN to be down for ~24 hours until os-config is triggered
                  by systemd timer
              footer:
                Change-type: minor
                change-type: minor
              author: ab77
              nested: []
          version: meta-balena-2.98.0
          title: "'Refresh PKI assets from config endpoint'"
          date: 2022-04-23T10:43:47.657Z
        - commits:
            - subject: Update balena-engine to v20.10.16
              hash: 7affe9d563250d79906ffc26401d8d7beea74114
              body: |
                Update balena-engine from 20.10.12 to 20.10.16
              footer:
                Change-type: minor
                change-type: minor
                Signed-off-by: Leandro Motta Barros <leandro@balena.io>
                signed-off-by: Leandro Motta Barros <leandro@balena.io>
                Changelog-entry: Update balena-engine to v20.10.16
                changelog-entry: Update balena-engine to v20.10.16
              author: Leandro Motta Barros
              nested:
                - commits:
                    - subject: "contrib/init/systemd: update balena-engine.service"
                      hash: 4d3b831bfbe197a68792a3baf33cbea639811763
                      body: |
                        Currently this file is used by Buildroot.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: TIAN Yuanhao <tianyuanhao3@163.com>
                        signed-off-by: TIAN Yuanhao <tianyuanhao3@163.com>
                      author: TIAN Yuanhao
                      nested: []
                  version: balena-engine-20.10.16
                  title: "'update balena-engine.service'"
                  date: 2022-04-07T05:22:26.128Z
                - commits:
                    - subject: Log more info upon when raising errRootFSMismatch
                      hash: ab3db5c03663e0b2ee35213ceebf9038e4af6b62
                      body: >
                        We currently do not log any information to help us
                        understanding the

                        underlying issue -- not even to identify what is the exact point in

                        which the error is raised. This commit improves on this situation.
                      footer:
                        Signed-off-by: Leandro Motta Barros <leandro@balena.io>
                        signed-off-by: Leandro Motta Barros <leandro@balena.io>
                        Change-type: patch
                        change-type: patch
                      author: Leandro Motta Barros
                      nested: []
                  version: balena-engine-20.10.15
                  title: "'Configure Renovate'"
                  date: 2022-04-05T07:56:50.137Z
                - commits:
                    - subject: Add more integration tests for deltas
                      hash: 59f6cd6dc32ee178532dbf7595933ef606cebf39
                      body: >
                        This adds two new integration tests:


                        * TestDeltaSize: this is meant to catch regressions on delta sizes. It
                          generates deltas and compare their sizes with the delta sizes we get
                          as of now. If the size increases, the test fails.
                        * TestDeltaCorrectness: checks if applying a delta indeed results in the
                          same image as we had originally.

                        A number of different test cases (different images with distinct

                        features) are tested for each of these integration tests.
                      footer:
                        Signed-off-by: Leandro Motta Barros <leandro@balena.io>
                        signed-off-by: Leandro Motta Barros <leandro@balena.io>
                        Change-type: patch
                        change-type: patch
                      author: Leandro Motta Barros
                      nested: []
                  version: balena-engine-20.10.14
                  title: "'Add more integration tests for deltas'"
                  date: 2022-04-01T13:30:28.649Z
                - commits:
                    - subject: Add link to post to test landr
                      hash: 4688b2395c49dcd350a6107824da61a13a1c4765
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                      author: andrew
                      nested: []
                  version: balena-engine-20.10.13
                  title: "'Add link to post to test landr'"
                  date: 2022-03-09T23:12:06.832Z
          version: meta-balena-2.97.0
          title: "'balena-engine: Update to 20.10.16'"
          date: 2022-04-23T01:23:49.298Z
  version: 2.98.0
  title: "'Update layers/meta-balena digest to 5498ce0'"
  date: 2022-04-23T14:46:30.161Z
- commits:
    - subject: Update layers/meta-balena to 0a58c6cdfc324e3fca540c48a119084669f99558
      hash: 2d52f096c8e9e994a809d2baddf68ddb739dc19f
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to 0a58c6cdfc324e3fca540c48a119084669f99558
        changelog-entry: Update layers/meta-balena to 0a58c6cdfc324e3fca540c48a119084669f99558
      author: Renovate Bot
      nested:
        - commits:
            - subject: "kernel-balena: Mention https protocol for github repository"
              hash: e3ee5b0b70827fa5ae1f70b0721d9125885affe5
              body: |
                Github now requires for the https protocol to be used
                when cloning repositories.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alexandru Costache <alexandru@balena.io>
                signed-off-by: Alexandru Costache <alexandru@balena.io>
              author: Alexandru Costache
              nested: []
          version: meta-balena-2.96.1
          title: "'kernel-balena: Mention https protocol for github repository'"
          date: 2022-04-22T17:25:18.183Z
    - subject: Update layers/meta-balena to b7490ca45f22591b1e6f7fddc1bf5853f373c125
      hash: deac9c6a3ae208477a16e09cfe3a735ddda507e8
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to b7490ca45f22591b1e6f7fddc1bf5853f373c125
        changelog-entry: Update layers/meta-balena to b7490ca45f22591b1e6f7fddc1bf5853f373c125
      author: Renovate Bot
      nested:
        - commits:
            - subject: "kernel-balena: Mention https protocol for github repository"
              hash: e3ee5b0b70827fa5ae1f70b0721d9125885affe5
              body: |
                Github now requires for the https protocol to be used
                when cloning repositories.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alexandru Costache <alexandru@balena.io>
                signed-off-by: Alexandru Costache <alexandru@balena.io>
              author: Alexandru Costache
              nested: []
          version: meta-balena-2.96.1
          title: "'kernel-balena: Mention https protocol for github repository'"
          date: 2022-04-22T17:25:18.183Z
  version: 2.96.1
  title: "'Update layers/meta-balena digest to 0a58c6c'"
  date: 2022-04-22T23:33:59.214Z
- commits:
    - subject: Update balena-yocto-scripts to 63e2b61fa462be4f68a2b7d8ca5084fd2d7d09b2
      hash: 6985974b110f273434c7248b870f83e4936178af
      body: Update balena-yocto-scripts
      footer:
        Changelog-entry: Update balena-yocto-scripts to 63e2b61fa462be4f68a2b7d8ca5084fd2d7d09b2
        changelog-entry: Update balena-yocto-scripts to 63e2b61fa462be4f68a2b7d8ca5084fd2d7d09b2
      author: Renovate Bot
      nested:
        - commits:
            - subject: "balena-lib: fix 'fatal: unsafe repository'"
              hash: 445d6d1fcfce97f85ffcfedc0083eb658a734321
              body: |
                Git 2.35.2 was released to fix a security issue with multi-user
                machines. Add `device_dir` to the whitelist to avoid this error.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Joseph Kogut <joseph@balena.io>
                signed-off-by: Joseph Kogut <joseph@balena.io>
              author: Joseph Kogut
              nested: []
          version: balena-yocto-scripts-1.19.2
          title: "'balena-lib: fix 'fatal: unsafe repository''"
          date: 2022-04-21T23:56:18.934Z
  version: 2.95.17+rev1
  title: "'Update balena-yocto-scripts digest to 63e2b61'"
  date: 2022-04-22T17:13:27.008Z
- commits:
    - subject: Update layers/meta-balena to 7730a5a3808f7d154b47831f930adedecde1cbba
      hash: ee1282963d4be3a75c0b0c481e15f194db61c4bb
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to 7730a5a3808f7d154b47831f930adedecde1cbba
        changelog-entry: Update layers/meta-balena to 7730a5a3808f7d154b47831f930adedecde1cbba
      author: Renovate Bot
      nested:
        - commits:
            - subject: "resin-device-register: avoid blocking the flasher when not connected"
              hash: b5c521404c14df8a5d14e2789c97eebe79eb7d96
              body: >
                Starting with v2.91.6 device provisioning will not start if the
                device

                was unable to register in the cloud due to lack of internet connectivity.

                To avoid this, we switch to retrying 3 times with the usual 2 second delay

                between attempts, after which the flashing process will start.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alexandru Costache <alexandru@balena.io>
                signed-off-by: Alexandru Costache <alexandru@balena.io>
              author: Alexandru Costache
              nested: []
          version: meta-balena-2.95.17
          title: "'resin-device-register: improve provisioning'"
          date: 2022-04-22T08:33:14.274Z
        - commits:
            - subject: Package iwlwifi-QuZ-a0-hr-b0 firmware separately
              hash: 261534942e5fe5b60680f51b129f33f00363a88e
              body: |
                We add this fw on its own package so that boards can add it to
                rootfs (for Intel NUC 11th generation more specifically)
              footer:
                Changelog-entry: Package iwlwifi-QuZ-a0-hr-b0 firmware separately
                changelog-entry: Package iwlwifi-QuZ-a0-hr-b0 firmware separately
                Change-type: patch
                change-type: patch
                Signed-off-by: Florin Sarbu <florin@balena.io>
                signed-off-by: Florin Sarbu <florin@balena.io>
              author: Florin Sarbu
              nested: []
          version: meta-balena-2.95.16
          title: "'linux-firmware: Package iwlwifi-QuZ-a0-hr-b0 firmware'"
          date: 2022-04-19T13:00:33.214Z
  version: 2.95.17
  title: "'Update layers/meta-balena digest to 7730a5a'"
  date: 2022-04-22T13:10:33.048Z
- commits:
    - subject: Update layers/meta-balena to 831819bead130a779bfa204b7d1df483486f0eaf
      hash: eb6115714ba814d4e6d6c4c91029911aff689728
      body: Update layers/meta-balena
      footer:
        Changelog-entry: Update layers/meta-balena to 831819bead130a779bfa204b7d1df483486f0eaf
        changelog-entry: Update layers/meta-balena to 831819bead130a779bfa204b7d1df483486f0eaf
      author: Renovate Bot
      nested:
        - commits:
            - subject: "kernel-headers-test: clean tools like fixdep"
              hash: bdc217b2da79349989f32b65454a4e5e2509fa1a
              body: |
                Let's ensure tools like fixdep are built in container
                and not reused from the yocto build, otherwise they
                may not run if they were linked against a different
                version of libc that may not be available in the kernel
                modules build container.

                This fixes the following error encountered when doing
                a Poky Honister build for the balena-intel repository:

                  scripts/basic/fixdep: /lib64/libc.so.6: version `GLIBC_2.34'
                  not found (required by scripts/basic/fixdep)
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alexandru Costache <alexandru@balena.io>
                signed-off-by: Alexandru Costache <alexandru@balena.io>
              author: Alexandru Costache
              nested: []
          version: meta-balena-2.95.15
          title: "'kernel-headers-test: clean tools like fixdep'"
          date: 2022-04-06T12:39:17.305Z
        - commits:
            - subject: Updates SIM info for soracom and provides docs.
              hash: 4706cc1f52e345e3409cd9580cdc9a1372545164
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Bucknall <alex.bucknall@gmail.com>
                signed-off-by: Alex Bucknall <alex.bucknall@gmail.com>
              author: Alex
              nested: []
          version: meta-balena-2.95.14
          title: "'Updates SIM info for soracom and provides docs.'"
          date: 2022-04-06T08:53:44.650Z
        - commits:
            - subject: "test/hup: fix unmounting error"
              hash: 3a318468d90632360109aeea994a51819347742a
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
          version: meta-balena-2.95.13
          title: "'test/hup: fix unmounting error'"
          date: 2022-04-06T07:56:32.752Z
        - commits:
            - subject: "grub-efi: Remove patch passing secure boot status to the kernel"
              hash: fb171dc507348e11ab2c6ed894289f51689fc874
              body: >
                This was originally introduced in combination with a kernel
                patch backported

                from Red Hat kernel that would enable kernel lockdown when secure boot

                is enabled. We have since changed the approach, dropped the kernel patch

                and when in secure boot mode use a different GRUB config file that enables

                lockdown on kernel command line unconditionally.


                That said, while the patch works fine, we do not really need it and it adds

                extra overhead porting it to newer yocto versions so there is no point keeping

                it at this moment. If in the future there is need for the kernel to know

                whether it is in secure boot mode or not, we can roll this back and rebase.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Michal Toman <michalt@balena.io>
                signed-off-by: Michal Toman <michalt@balena.io>
              author: Michal Toman
              nested: []
          version: meta-balena-2.95.12
          title: "'grub-efi: Remove patch passing secure boot status to the kernel'"
          date: 2022-03-31T14:45:57.845Z
        - commits:
            - subject: "hostapp-update: Mount data partition on target balena/tmp"
              hash: 548c6c08f041f69786f0092eb2397f2fbf8e7e86
              body: >
                In most cases there is not enough space on rootfs to extract

                and load a local hostapp image when the balena-host tmpdir

                is on the same partition.


                This uses a data mount to ensure temporary extracted files of the

                compressed image will not fill the target sysroot.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
          version: meta-balena-2.95.11
          title: "'hostapp-update: Mount data partition on target balena/tmp'"
          date: 2022-03-30T17:20:46.022Z
        - commits:
            - subject: "tests/os: check supervisor is pulled  after purge"
              hash: 58a645684921797383602311821522604064fd62
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
          version: meta-balena-2.95.10
          title: "'tests/os: check supervisor is pulled  after purge'"
          date: 2022-03-30T11:28:54.776Z
        - commits:
            - subject: "tests: update leviathan to 2.0.4"
              hash: b90c280d8f08497fcf2ca7b5329bdb7e7dc7c22a
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
            - subject: "tests: update config for new leviathan version"
              hash: 788cacc8daadf487698e28e2ad308cc54f1d96b4
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
          version: meta-balena-2.95.9
          title: "'tests: update config for new leviathan version'"
          date: 2022-03-28T12:52:25.738Z
        - commits:
            - subject: "resindataexpander: Check and fix end GPT if necessary"
              hash: 5d2435e17851f44f17cfba491b01f766d7930317
              body: >
                Under certain circumstances that we haven't reproduced,

                it is reported that the alternate GPT may become corrupt,

                preventing the device from booting.


                Should this happen, we use sgdisk to check and recover the end gpt

                from the main one.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alexandru Costache <alexandru@balena.io>
                signed-off-by: Alexandru Costache <alexandru@balena.io>
              author: Alexandru Costache
              nested: []
          version: meta-balena-2.95.8
          title: "'Add gpt check'"
          date: 2022-03-25T08:08:23.471Z
        - commits:
            - subject: "hostapp-update-hooks: Always update legacy development variants to
                development mode"
              hash: 8c7bd8d87d0db97851528f97c4853097c63273e4
              body: >
                A legacy development image will update to development mode
                enabled

                independently of whether the newOS is configured for development mode or

                not. The only case when a hostapp has developmentMode set is when locally

                building with `OS_DEVELOPMENT`.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: meta-balena-2.95.7
          title: "'Always update legacy development variants to development mode'"
          date: 2022-03-23T12:47:07.162Z
        - commits:
            - subject: "balena-supervisor: Use architecture instead of device type to query
                API"
              hash: 419e1eefe64b6e5ffc9ff370e50cd256a319ef2c
              body: >
                This caters for the use case of custom device types that are not

                registered in balena-cloud but still need to fetch the supervisor from

                balena-cloud's registry by querying the `supervisor_version` endpoint,

                for example when using openBalena.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "update-balena-supervisor: Support passing command line image argument"
              hash: 227fea72a17c00bcd7e8ee069414ccc006703072
              body: >
                For balena-cloud managed devices, the supervisor update data is
                managed

                by the API.


                Providing the image name in the command line provides an update path

                for unmanaged devices, manual updates on ESR devices (which currently

                do not allow dashboard based updates) and openBalena use cases.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: meta-balena-2.95.6
          title: "'Supervisor update enhacements'"
          date: 2022-03-22T15:05:51.376Z
        - commits:
            - subject: "tests/kernel-overlap: Prevent test run failure on older kernels"
              hash: 3d230a9d003988924b6c16720d554c9f48a05c16
              body: >
                The issue that this test is aimed at has been introduced in

                kernel versions above 4.13. On older kernels like for instance

                4.9, the test will not pass.


                Let's run this test on kernel versions where the issue was present.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alexandru Costache <alexandru@balena.io>
                signed-off-by: Alexandru Costache <alexandru@balena.io>
              author: Alexandru Costache
              nested: []
          version: meta-balena-2.95.5
          title: "'tests/kernel-overlap: Prevent test run failure on older kernels'"
          date: 2022-03-21T15:04:59.766Z
        - commits:
            - subject: "tests/os: wait for osconfig service to be inactive"
              hash: da59749c901057a55adaf990643fc235480156aa
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
          version: meta-balena-2.95.4
          title: "'Fix dns test'"
          date: 2022-03-17T17:38:43.827Z
        - commits:
            - subject: "balena-supervisor: Update balena-supervisor to v12.11.38 Ensure
                preloaded applications are ran when no internet is available on
                first run"
              hash: 08058f8671704f7d925ed97c3202b3620570a95b
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: 20k-ultra <3946250+20k-ultra@users.noreply.github.com>
                signed-off-by: 20k-ultra <3946250+20k-ultra@users.noreply.github.com>
              author: 20k-ultra
              nested: []
          version: meta-balena-2.95.3
          title: "'balena-supervisor: Update balena-supervisor to v12.11.38'"
          date: 2022-03-15T23:32:43.991Z
        - commits:
            - subject: "kernel-balena: Disable building gcc plugins"
              hash: bd8d2de9983f47e46ffa0e689be88c5b12e46617
              body: >
                Since
                https://github.com/raspberrypi/linux/commit/1eee36a5520b5a89fb4d0d6af6f9cb0217a3164f

                was merged and included in kernel versions after 5.10.84,

                building the kernel-modules-headers fails due to various missing

                headers from the gmp and mpc packages. This problem is visible

                only after upgrading to a newer kernel, because until now the

                gcc plugins kernel config was not enabled at all, due to the

                failed check in the above mentioned patch.


                Since we are not using the functions provided

                by the gcc plugins anyway, we can disable this

                config.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alexandru Costache <alexandru@balena.io>
                signed-off-by: Alexandru Costache <alexandru@balena.io>
              author: Alexandru Costache
              nested: []
          version: meta-balena-2.95.2
          title: "'kernel-balena: Disable building of gcc plugins'"
          date: 2022-03-11T17:26:05.533Z
        - commits:
            - subject: "tests: Add leviathan v2.0.0 as a submodule"
              hash: 49b6fd8e07edc4facdef13795fa4fe079958977c
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
            - subject: "tests/cloud: Cleanup wait until loops in cloud suite"
              hash: 65775fdf08d260ee7a87dbe262038bc9831780f7
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
            - subject: "tests/hup: Remove bluebird and this.context.get references"
              hash: be472ff82d27a0ff5a67fd3202ae15e63aafb685
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
            - subject: "tests/os: Remove bluebird and this.context.get references"
              hash: c3570af3bd58f5fd8a134ffe5d71bce970b3ade8
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
            - subject: "tests/cloud: Remove bluebird and this.context.get references"
              hash: 8c901905dadfb66a157f05ed9fcea2f6499e15bd
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
            - subject: "tests: Cleanup suites config to support both testbot and qemu workers"
              hash: e48e71e0bd2533806e7eff31f74b3e3a243e9493
              body: >
                This avoids having to make perl regex changes in yocto-scripts
                or in Jenkins.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
            - subject: "tests/cloud: Update cloud suite to support core on client"
              hash: 428d9d616edacbaf70df9df0f76bc731af247c98
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
            - subject: "tests/hup: Update hup suite to support core on client"
              hash: 2f386863408f32b0197090e786c46605e2ab7fcb
              body: >
                This also removes the need for a registry and performs hup from
                file.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
            - subject: "tests/os: Update os suite to support core on client"
              hash: fe68f8192c4875b575f86bc41c6e3ff9fb27f587
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
          version: meta-balena-2.95.1
          title: "'tests: Suite updates for compatiblity with core moved to client'"
          date: 2022-03-08T18:48:12.462Z
        - commits:
            - subject: Adds modem test suite
              hash: c3cc64723e8a8d50aa5c6d4ece52d2c5a3b90e8a
              body: ""
              footer:
                Change-type: minor
                change-type: minor
                Signed-off-by: Alex Bucknall <alex.bucknall@gmail.com>
                signed-off-by: Alex Bucknall <alex.bucknall@gmail.com>
              author: Alex
              nested: []
          version: meta-balena-2.95.0
          title: "'Adds modem test suite'"
          date: 2022-03-04T18:27:18.723Z
        - commits:
            - subject: Use by-state symlink for mounting the EFI partition when split
              hash: 42d8ac8daaee2a67d5666c7220e1b9cd0e013e6e
              body: >
                In the current state the by-state symlink for balena-efi
                partition

                is not generated for two reasons:

                - 60-resin-update-state.rules only react to resin-* partition names

                - the root device is not identified correctly in resin_update_state_probe
                  for LUKS devices

                This patch fixes both the issues and makes use of the by-state symlink

                instead of by-label.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Michal Toman <michalt@balena.io>
                signed-off-by: Michal Toman <michalt@balena.io>
              author: Michal Toman
              nested: []
            - subject: "os-helpers: add TPM2 helpers"
              hash: 78f7da3a3cdf1942861195238a6cea691899a140
              body: >
                This helps with code duplication in flasher and initrd scripts
                using

                the TPM to manipulate LUKS passphrase.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Michal Toman <michalt@balena.io>
                signed-off-by: Michal Toman <michalt@balena.io>
              author: Michal Toman
              nested: []
            - subject: Add PCR protection policy to TPM operation unlocking LUKS passphrase
              hash: aa76a9b45e18192ecaa67f17ef68f9cfc4d66a66
              body: >
                This patch adds the check for PCRs

                - 0 - firmware/UEFI blob

                - 1 - firmware/UEFI config

                - 2 - Expansion card firmware blobs

                - 3 - Expansion card firmware configs


                The full protection is only applied on first boot after provisioning,

                flasher only locks against PCRs 0, 2 and 3.

                This is because when using flasher, the environment is not in the same

                state as the one we want to lock to. In particular the boot order is

                different (flasher is booted from a different drive than the resulting OS).

                As for now we were not able to find a better solution than fully locking

                only on first boot. This means the device must be booted in a secure

                environment at least once after provisioning.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Michal Toman <michalt@balena.io>
                signed-off-by: Michal Toman <michalt@balena.io>
              author: Michal Toman
              nested: []
          version: meta-balena-2.94.5
          title: "'Add PCR protection to LUKS/TPM manipulation'"
          date: 2022-03-04T13:12:52.505Z
  version: 2.95.15
  title: "'Update layers/meta-balena digest to 831819b'"
  date: 2022-04-14T19:57:18.136Z
- commits:
    - subject: Update balena-yocto-scripts to ff9465a20e32843b3b01ec3efa0d8a5390e6d66c
      hash: 1f36d049e474fa16904f904a9e1fdf22ba1e01d0
      body: Update balena-yocto-scripts
      footer:
        Changelog-entry: Update balena-yocto-scripts to ff9465a20e32843b3b01ec3efa0d8a5390e6d66c
        changelog-entry: Update balena-yocto-scripts to ff9465a20e32843b3b01ec3efa0d8a5390e6d66c
      author: Renovate Bot
      nested:
        - commits:
            - subject: "deploy: ensure deployRawArtifact is empty instead of null"
              hash: 56edfe62d6ecede3e07b0b51653ca605a2e4ba83
              body: >
                jq returns null by default when a given key isn't found, ensure
                that

                when getting the value of deployRawArtifact, we get an empty variable

                instead, which is checked later on to determine if that file should be

                deployed
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Joseph Kogut <joseph@balena.io>
                signed-off-by: Joseph Kogut <joseph@balena.io>
              author: Joseph Kogut
              nested: []
          version: balena-yocto-scripts-1.19.1
          title: "'deploy: ensure deployRawArtifact is empty instead of null'"
          date: 2022-04-14T16:02:35.647Z
        - commits:
            - subject: "deploy: push image variant artifacts"
              hash: f5b7ae35f2f2996d93ba572919e26e1487a79f79
              body: ""
              footer:
                Change-type: minor
                change-type: minor
                Signed-off-by: Joseph Kogut <joseph@balena.io>
                signed-off-by: Joseph Kogut <joseph@balena.io>
              author: Joseph Kogut
              nested: []
          version: balena-yocto-scripts-1.19.0
          title: "'deploy: push image variant artifacts'"
          date: 2022-04-13T14:36:11.268Z
        - commits:
            - subject: Bump balena-cli to v.Latest
              hash: 6aec14bf20674e62822ba41f56ef2763c4036b6d
              body: |
                * remove SSH key injection
              footer:
                Change-type: minor
                change-type: minor
              author: ab77
              nested: []
          version: balena-yocto-scripts-1.18.0
          title: "'Bump balena-cli to v.Latest'"
          date: 2022-03-31T20:52:47.275Z
        - commits:
            - subject: Remove superfluous preload flag
              hash: a124b525ca058ead27eb43c0a799eb692c79fa80
              body: ""
              footer:
                Change-type: patch
                change-type: patch
              author: ab77
              nested: []
          version: balena-yocto-scripts-1.17.12
          title: "'Remove superfluous preload flag'"
          date: 2022-03-29T17:38:21.495Z
        - commits:
            - subject: Unattended preload operation
              hash: 1fecbb4d000b1a403f192a63d5e2921ded56647c
              body: >
                * the CLI prompts for input during preload


                Alternatively, the --pin-device-to-release flag may be used to pin only the

                preloaded device to the selected release.


                Would you like to disable automatic updates for this fleet now? No


                * we do not want to set the suggested flag and we do not want to touch the fleet release policy for this use case
              footer:
                Change-type: patch
                change-type: patch
              author: ab77
              nested: []
          version: balena-yocto-scripts-1.17.11
          title: "'Unattended preload operation'"
          date: 2022-03-29T14:36:18.054Z
        - commits:
            - subject: Pass environment to docker
              hash: ac8be68fb073aed53b21b2e66df4fb54adb64e22
              body: ""
              footer:
                Change-type: patch
                change-type: patch
              author: ab77
              nested: []
          version: balena-yocto-scripts-1.17.10
          title: "'Pass environment to docker'"
          date: 2022-03-28T17:26:04.107Z
        - commits:
            - subject: "automation: ami: make BALENA_PRELOAD_COMMIT optional"
              hash: b365cb9ba359637a3a6a8451b8d83142bb167571
              body: >
                Remove BALENA_PRELOAD_COMMIT from required env vars, as we have
                a

                default if it's not specified.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Joseph Kogut <joseph@balena.io>
                signed-off-by: Joseph Kogut <joseph@balena.io>
              author: Joseph Kogut
              nested: []
          version: balena-yocto-scripts-1.17.9
          title: "'automation: ami: make BALENA_PRELOAD_COMMIT optional'"
          date: 2022-03-25T23:25:09.583Z
        - commits:
            - subject: "balena-deploy: s/resin-flasher/balena-flasher"
              hash: abdae4c86ed213a64bb1fa7498f4837f53d95448
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Joseph Kogut <joseph@balena.io>
                signed-off-by: Joseph Kogut <joseph@balena.io>
              author: Joseph Kogut
              nested: []
          version: balena-yocto-scripts-1.17.8
          title: "'balena-deploy: s/resin-flasher/balena-flasher'"
          date: 2022-03-15T20:11:21.544Z
        - commits:
            - subject: "jenkins_generate_ami: surface preload app commit as variable"
              hash: 7248b344198ba09a219ee227ffea4b6f0a4850d7
              body: >
                Surface the preloaded app commit as a variable that can be
                overridden in

                the build job. Default to "current" to maintain existing behavior when

                the variable isn't set.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Joseph Kogut <joseph@balena.io>
                signed-off-by: Joseph Kogut <joseph@balena.io>
              author: Joseph Kogut
              nested: []
          version: balena-yocto-scripts-1.17.7
          title: "'jenkins_generate_ami: surface preload app commit as variable'"
          date: 2022-03-15T16:36:33.654Z
  version: 2.94.4+rev5
  title: "'Update balena-yocto-scripts digest to ff9465a'"
  date: 2022-04-14T18:53:50.072Z
- commits:
    - subject: Add renovate configuration
      hash: 50953fe43654620686aaeb3b8124d78496cce6d6
      body: ""
      footer:
        Changelog-entry: Add renovate configuration
        changelog-entry: Add renovate configuration
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 2.94.4+rev4
  title: "'Add renovate configuration'"
  date: 2022-04-14T10:48:21.281Z
- commits:
    - subject: Use correct dtb name in u-boot for R2C or R2S
      hash: 02951ba873cb5ca36d7ebfcdc2ccaa0242051da1
      body: ""
      footer:
        Changelog-entry: Use correct dtb name in u-boot for R2C or R2S
        changelog-entry: Use correct dtb name in u-boot for R2C or R2S
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 2.94.4+rev3
  title: "'u-boot: Use correct dtb name for R2C or R2S'"
  date: 2022-04-14T09:12:03.520Z
- commits:
    - subject: Add support for NanoPi R2S
      hash: 5e26585c5611f30a2026d2719f4c14d99d51e637
      body: |
        We are adding support for NanoPi R2S as per customer request
      footer:
        Changelog-entry: Add support for NanoPi R2S
        changelog-entry: Add support for NanoPi R2S
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 2.94.4+rev2
  title: "'Add nanopi r2s'"
  date: 2022-04-13T14:23:08.993Z
- commits:
    - subject: Specify full path in repo.yml upstreams
      hash: 39a69532e9ce1612c99dbcc6a65e4d124c351f27
      body: |
        This is required so that versionist can automatically include nested
        changelogs from renovate PRs.
      footer:
        Changelog-entry: Specify full path in repo.yml upstreams
        changelog-entry: Specify full path in repo.yml upstreams
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 2.94.4+rev1
  title: "'repo.yml: Specify full path in upstream'"
  date: 2022-04-13T13:53:22.636Z
- commits:
    - subject: Update meta-balena from v2.91.1 to v2.94.4
      hash: 8bc011d8b8502ed7ba0a582734badb0194b5494d
      body: |
        Update meta-balena from 2.91.1 to 2.94.4
      footer:
        Changelog-entry: Update meta-balena from v2.91.1 to v2.94.4
        changelog-entry: Update meta-balena from v2.91.1 to v2.94.4
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested:
        - commits:
            - subject: "balena-supervisor: Fix supervisor tagging command"
              hash: d25d6289b14edd9111d6abbc45448693ca872036
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Florin Sarbu <florin@balena.io>
                signed-off-by: Florin Sarbu <florin@balena.io>
              author: Florin Sarbu
              nested: []
          version: meta-balena-2.94.4
          title: "'balena-supervisor: Fix supervisor tagging command'"
          date: 2022-03-04T05:54:28.770Z
        - commits:
            - subject: "tests/os: fix bracket in bbb overlay test"
              hash: c11bc9d3e8ad4102f1b0d38a4d2658222687e156
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
          version: meta-balena-2.94.3
          title: "'tests/os: fix bracket in bbb overlay test'"
          date: 2022-03-02T12:06:17.701Z
        - commits:
            - subject: "tests: Enhance BeagleBone Black u-boot overlay test"
              hash: 0051fa51e15b092f16b264cdf4a0147e37e5fd25
              body: |
                Let's make sure that when we finish the test we leave
                uEnv.txt as before we started the test.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Florin Sarbu <florin@balena.io>
                signed-off-by: Florin Sarbu <florin@balena.io>
              author: Florin Sarbu
              nested: []
          version: meta-balena-2.94.2
          title: "'tests: Enhance BeagleBone Black u-boot overlay test'"
          date: 2022-03-02T09:01:45.548Z
        - commits:
            - subject: "balena-image: Default image type to balenaos-img"
              hash: a3c276a1058d05e66991871bf167079fc2824843
              body: >
                This avoids device repositories having to specify it, and it can
                always

                be overwritten in append files.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: Remove legacy resinhup images.
              hash: d895c90e6382da56f7327305b3def4ab5b37742c
              body: >
                These image types are no longer generated and are not used for
                hostOS

                updates any longer.
              footer:
                Changelog-entry: Remove legacy resinhup images.
                changelog-entry: Remove legacy resinhup images.
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: meta-balena-2.94.1
          title: "'images: Remove generation of legacy resinhup images'"
          date: 2022-03-01T20:45:50.839Z
        - commits:
            - subject: Update balena-supervisor to v12.11.36
              hash: 8e9c3d992a5d681701580f52e5f9ba3d696bf1d8
              body: >
                Update balena-supervisor from 12.11.32 to 12.11.36


                Includes a fix for https://github.com/balena-os/balena-supervisor/issues/1890
              footer:
                Change-type: patch
                change-type: patch
                Changelog-entry: Update balena-supervisor to v12.11.36
                changelog-entry: Update balena-supervisor to v12.11.36
                Signed-off-by: Robert Gnzler robertg@balena.io
                signed-off-by: Robert Gnzler robertg@balena.io
              author: Robert Gnzler
              nested:
                - commits:
                    - subject: Ignore selinux security opts when comparing services
                      hash: 1b54ce8bfd5dd3d1f14f573a0bfe17ee1dd81630
                      body: >
                        The moby engine v20.x.y adds some selinux [security
                        configurations](https://docs.docker.com/engine/reference/run/#security-configuration)

                        depending on the [container configuration](https://github.com/moby/moby/blob/master/daemon/create.go#L214).

                        This would cause the supervisor to enter a service restart loop as the

                        current and target service configurations will never match. The

                        supervisor now ignores selinux specific security options since those are

                        not supported by balenaOS.
                      footer:
                        Closes: "#1890"
                        closes: "#1890"
                        Change-type: patch
                        change-type: patch
                      author: Felipe Lalanne
                      nested: []
                  version: balena-supervisor-12.11.36
                  title: "'Ignore selinux security opts when comparing services'"
                  date: 2022-02-23T21:15:31.484Z
                - commits:
                    - subject: Add troubleshooting notice for macOS
                      hash: 6ab314f8c0af647cdb0537b6a396ccb3d5ce060f
                      body: >
                        When developing on macOS (Darwin) DBus may have to be
                        installed.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: fisehara <harald@balena.io>
                        signed-off-by: fisehara <harald@balena.io>
                      author: fisehara
                      nested: []
                  version: balena-supervisor-12.11.35
                  title: "'Add troubleshooting notice for macOS'"
                  date: 2022-02-16T19:41:22.558Z
                - commits:
                    - subject: Create `touch` and `getBootTime` utility functions
                      hash: a4d91d381a3e2dfda182bb7809a6d78b18aafebf
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                      author: Felipe Lalanne
                      nested: []
                    - subject: Add update lock check to PATCH /v1/device/host-config
                      hash: 5f1a77da25b9d0bd07c2fbec85cb5deefae18884
                      body: >
                        This is necessary with the changes as of balenaOS
                        2.82.6, which watches config.json

                        and will restart balena-hostname and some other services automatically on file change.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Relates-to: "#1876"
                        relates-to: "#1876"
                        Signed-off-by: Christina Wang <christina@balena.io>
                        signed-off-by: Christina Wang <christina@balena.io>
                      author: Christina Wang
                      nested: []
                  version: balena-supervisor-12.11.34
                  title: "'Make the supervisor more resistant to restarts during config changes'"
                  date: 2022-02-15T15:58:42.783Z
                - commits:
                    - subject: Add support for local ipv6 reporting
                      hash: 72f6cbe4c7225623ed99083d20c4a2cb2f3b70ac
                      body: >
                        With more and more devices in ipv6 only networks, this
                        ensures the

                        local addresses are reported to the cloud as part of the state patch.
                      footer:
                        Change-type: patch
                        change-type: patch
                      author: Felipe Lalanne
                      nested: []
                  version: balena-supervisor-12.11.33
                  title: "'Add support for local ipv6 reporting'"
                  date: 2022-02-09T17:57:09.778Z
            - subject: "meta-resin-pyro: make sure $GO is set"
              hash: f618d4575068be226b2fd6da5b74d6604236e5d5
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Robert Gnzler <robertg@balena.io>
                signed-off-by: Robert Gnzler <robertg@balena.io>
              author: Robert Gnzler
              nested: []
            - subject: Refactor balena-engine recipe to more closely resemble upstream
              hash: 1280c281d79b413d885e44dbf507a2b59005f25b
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Changelog-entry: Refactor balena-engine recipe to more closely resemble upstream
                changelog-entry: Refactor balena-engine recipe to more closely resemble upstream
                Signed-off-by: Robert Gnzler <robertg@balena.io>
                signed-off-by: Robert Gnzler <robertg@balena.io>
              author: Robert Gnzler
              nested: []
            - subject: Update Golang recipes to 1.16.2
              hash: 475adc63cf7902fbc91a32e53a02af8d275daf2c
              body: |
                This reverts commit 4303346ccda6d3e3c4f83cc3782c73a6d1adb494.
              footer:
                Change-type: minor
                change-type: minor
                Changelog-entry: Update Golang recipes to 1.16.2
                changelog-entry: Update Golang recipes to 1.16.2
                Signed-off-by: Robert Gnzler <robertg@balena.io>
                signed-off-by: Robert Gnzler <robertg@balena.io>
              author: Robert Gnzler
              nested: []
            - subject: Update balena-engine to v20.10.12
              hash: ae632d7fb7cf10e0770c6f511dd9f454ee0d9dac
              body: |
                Update balena-engine from 19.03.30 to 20.10.12
              footer:
                Change-type: minor
                change-type: minor
                Changelog-entry: Update balena-engine to v20.10.12
                changelog-entry: Update balena-engine to v20.10.12
                Signed-off-by: Robert Gnzler <robertg@balena.io>
                signed-off-by: Robert Gnzler <robertg@balena.io>
              author: Robert Gnzler
              nested:
                - commits:
                    - subject: "storagemigration: keep going if migration fails"
                      hash: 2bde63c800b1df72fba7161d62b5b6da84a8d390
                      body: >
                        the only hard error is if rollback (failcleanup) fails,
                        in all other

                        scenarios we want the daemon to continue starting with the new

                        graphdriver
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "graphdriver/copy: fix handling of sockets"
                      hash: 17a198cb53a53da456c848bf303dc3917ca538c5
                      body: >
                        previously switch would treat S_IFIFO and S_IFSOCK as
                        the same, passing

                        both of the to mkfifo, which lead to EINVAL errors when trying to create

                        the socket, we instead handle socket separately.


                        Also adds cases for this to the unit and integration tests of the

                        migrator.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "pkg/storagemigration: use graphdriver/copy.DirCopy"
                      hash: ffbb608492405488bff5e31ea62c0249fb416106
                      body: |
                        instead of our own implementation
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Prune Jenkinsfile
                      hash: ea14e503181bbb248a4bed1b86a227d9c214cbfb
                      body: >
                        we are not using it for our CI, and it confuses jenkins
                        set up on the

                        balena-os org
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Backport platform-detection fixes from containerd
                      hash: 9f71253561b1cd2f262ec0d6e81c5fbd09a7a0a1
                      body: >
                        See https://github.com/containerd/containerd/pull/4530

                        and `git log ad25c1a9c34361e4071f508b9a91946b05fce165^..2055e12953bb538228d8d9fe627fa545d7cf82be ./platforms/`

                        in the containerd repo
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "storagemigration: capture failcleanup logs in logfile"
                      hash: 4f7f543eff08766bc584024afdb57760dfb52130
                      body: >
                        reorder the defer statements in the migrate function to
                        only teardown

                        the logger after the failcleanup function ran. otherwise errors logged

                        there won't show up in the logfile
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "storagemigration: move logic to package"
                      hash: 001835bf61172fdcfdb0416e000852ff05683c71
                      body: >
                        This brings all migration logic into a single call into
                        the

                        storagemigration package, which should make future maintenance easier

                        and fixes the cleanup logic bug, where the old aufs root would never be

                        cleaned up.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: prevent slice oob access in concatReadSeekCloser
                      hash: 1e7045ac957db17fe9838602c9339c0b5ae5c282
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                      author: Martin Rauscher
                      nested: []
                    - subject: Make layer download resuming more resilient
                      hash: 582487f832c59c2f734a780ab0492833f29002c9
                      body: >
                        This commit changes the way we retry layer downloads
                        after failures with

                        the goal of making it more resilient, especially for cases involving

                        large layers and unreliable network connections.


                        These are the changes:


                        * Make sure we also retry after failures in `v2LayerDescriptor.reset()`.
                          This method creates a new HTTP request to resume a failed download,
                          and therefore depends on a working network to succeed.
                        * Wait exponentially longer times between retries (instead of retrying
                          immediately as before). This shall increase of success in case of
                          network issues that take longer to get resolved.
                        * Increase the number of retries to 10.

                        * Reset retry count whenever we successfully download anything at all.
                          The idea is that we want to give up downloading only after a long
                          continuous period of failures. Combined with the exponential back-off
                          strategy and increased number of retries described above, a layer pull
                          will fail only after about 17 minutes.
                        * Add a bit more logging to help with troubleshooting.
                      footer:
                        Change-type: minor
                        change-type: minor
                        Signed-off-by: Leandro Motta Barros <leandro@balena.io>
                        signed-off-by: Leandro Motta Barros <leandro@balena.io>
                      author: Leandro Motta Barros
                      nested: []
                    - subject: Drop CODEOWNERS
                      hash: e70e1a9fe622563719993626e834c85efc17905c
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "pkg/storagemigration: poperly handle errors during state creation"
                      hash: b8170db554ac1d1abb3adcfe1f6265701e9147c5
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "pkg/storagemigration: allow writing logs to separate file"
                      hash: 77536d3866ac706f049a02d2eed44a7df1cb779c
                      body: >
                        This can be used to keep a record of failed migrations.

                        Only runs if BALENA_MIGRATE_OVERLAY_LOGFILE is set to a path on disk.

                        The log file will be deleted if there are no errors.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "storagemigration: defer commit to next start"
                      hash: bd1628e67136b78ca7e7c83c5569666207d28a84
                      body: >
                        With this change the aufs data is kept around until the
                        next time we

                        start. If we find both an aufs AND an overlay2 storage root, we cleanup

                        the aufs data.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Lock destination layers while delta is being processed
                      hash: 0ad4281e11e4d3ef263010787aecd244c0ce333d
                      body: >
                        During fingerpinting of the source image the destination
                        layers are not

                        exepmt from being released (e.g. when `balena image rm <iid>`) is run

                        simultaneously.

                        Similarly when processing the destination layers to generate deltas we

                        only hold one reference at a time, leaving the subsequent layers

                        vulnerable to the same issues.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Add aufs to overlay2 migrator
                      hash: b3a976b1294469e75222752bdc1fdc06bfcc97b8
                      body: >
                        The main logic is under pkg/storagemigration. This is
                        able to seamlessly

                        migrate images and containers from AUFS to overlay2.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Update the README
                      hash: 4a95df5bc30a40389191d9b2417b0f9bf35fefdc
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Cleanup repo
                      hash: de3a38940ab7410fbb3fd719190db401e419b77d
                      body: |
                        remove some obsolete files/directories
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Add a SECURITY.md
                      hash: 477d70db260a8dda71e2dba12ccd9f169fe9b480
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "top_unix.go: allow busybox ps with no args"
                      hash: 6617c4d76d275e05d6055d91aabbd7df25332342
                      body: >
                        Busybox in balenaOS is compiled with desktop mode
                        disabled,

                        so features like `-ef` and providing pids via `-q` are not

                        supported. Add a 3rd condition to try ps with no args and allow

                        parsePSOutput to filter by pid.


                        https://github.com/balena-os/balena-engine/issues/236
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Kyle Harding <kyle@balena.io>
                        signed-off-by: Kyle Harding <kyle@balena.io>
                      author: Kyle Harding
                      nested: []
                    - subject: Bump balena-os/balena-containerd to 1da48a8
                      hash: ab1a49816fd8ae2ec73dc83152ad06a05a6b9799
                      body: |
                        Fixes balena-engine-runc version format.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Connects-to: balena-os/balena-containerd#6
                        connects-to: balena-os/balena-containerd#6
                        Signed-off-by: Tian Yuanhao <tianyuanhao@aliyun.com>
                        signed-off-by: Tian Yuanhao <tianyuanhao@aliyun.com>
                      author: Tian Yuanhao
                      nested: []
                    - subject: Add changelog template to allow generating nested changelogs
                      hash: f272b547ee6c27c41be70da6b913699a2c5ef928
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Update github issue and pr templates
                      hash: 123449f806b691e3d193c340a9e72285839f8bb9
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Update codeowners
                      hash: 538f01a22413db44ce0304dedb704c285189d3a5
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "hack: Fix CLI versioning"
                      hash: a9d487d0751f7ad293ab66b3d24734505b41f85b
                      body: >
                        https://github.com/balena-os/balena-engine-cli/commit/20c19830a95455e8562551aad52c715ad0807cc6

                        moves the versioning variables to a separate package. We have to adjust

                        the location in hack/make.sh too
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Fixed typos in getting-started.md docs
                      hash: f162d15114fdb5d2ea87eee08979f1a5882f52cc
                      body: ""
                      footer:
                        Closes: "#209"
                        closes: "#209"
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Miguel Casqueira <miguel@balena.io>
                        signed-off-by: Miguel Casqueira <miguel@balena.io>
                      author: Miguel Casqueira
                      nested: []
                    - subject: Add integration tests for hostapp handling
                      hash: 0c18f60f1124567e51c752bb76d801c97bef5916
                      body: >
                        This refactors mobynit to allow for testing parts of it
                        from

                        the integration tests.

                        Also adds some sanity checks for "bare" containers.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Fix container data deletion
                      hash: bbdf9e2137de87696d758847a2eb544eb04d828e
                      body: >
                        Previous implementation was not comparing graphdriver
                        content to layerStore mounts.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Roman Mazur <roman@balena.io>
                        signed-off-by: Roman Mazur <roman@balena.io>
                      author: Roman Mazur
                      nested: []
                    - subject: "overlay2: Add List support"
                      hash: 90a45216050664742ed8088d5a00304dd097a791
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Roman Mazur <roman@balena.io>
                        signed-off-by: Roman Mazur <roman@balena.io>
                      author: Roman Mazur
                      nested: []
                    - subject: "aufs: Add List support"
                      hash: c2f02fec80c89a7ad907cb21a4dedee8db854fac
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Roman Mazur <roman@balena.io>
                        signed-off-by: Roman Mazur <roman@balena.io>
                      author: Roman Mazur
                      nested: []
                    - subject: "layer: Remove unreferenced driver layers on create"
                      hash: 152736dfbb764e6c74f1afc71df853e93488a91f
                      body: >
                        Earlier engine versions were not properly persisting
                        cacheID

                        in layer metadata. As a result, because of abruptly terminated transactions,

                        a lot of devices have unreferenced graphdriver layers on disk.


                        With this change, the engine will be able to clean up such unreferenced layers.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Roman Mazur <roman@balena.io>
                        signed-off-by: Roman Mazur <roman@balena.io>
                      author: Roman Mazur
                      nested: []
                    - subject: "layer: Prune unused data on layer store creation"
                      hash: 01e4688f8c4f42e769d319353accdc0c34ffcc0b
                      body: >
                        When layer store is created, its tmp directory may
                        contain information

                        about transactions that were abruptly treminated during the previous process run.

                        Such data is now identified before any new transactions can be created,

                        and a background process is started to delete both meta data and graph driver layeres.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Roman Mazur <roman@balena.io>
                        signed-off-by: Roman Mazur <roman@balena.io>
                      author: Roman Mazur
                      nested: []
                    - subject: "layer: Persist cacheID early on transaction start"
                      hash: b1709e0881b3ed61c1608ef5ed19acf8008b2275
                      body: >
                        If the engine process is terminated during the layer
                        extraction transaction,

                        before Commit or Cancel is called on the transaction, a new FS layer can be created

                        by the graph driver without any link to the layers metadata.


                        This change ensures we don't perform any actions on the graph driver storage until

                        the FS layer ID (the cacheID) is  persisted as a part of the transaction data.


                        We can use this data to clean up the graph driver storage on next process start

                        deleting all data associated with the transactions terminated abruptly.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Roman Mazur <roman@balena.io>
                        signed-off-by: Roman Mazur <roman@balena.io>
                      author: Roman Mazur
                      nested: []
                    - subject: "pkg/authorization: Fix test failures on macOS"
                      hash: 6e9af0514461f1ce3945ed308ef13e3ddbc7dc4f
                      body: >
                        On macOS, unit tests where failing with


                        root@c4101a75c792:/go/src/github.com/docker/docker/pkg/authorization# go test .

                        --- FAIL: TestAuthZRequestPluginError (0.00s)
                            authz_unix_test.go:295: listen unix authz-test-plugin.sock: bind: file name too long
                        --- FAIL: TestAuthZRequestPlugin (0.00s)
                            authz_unix_test.go:295: listen unix authz-test-plugin.sock: bind: file name too long
                        --- FAIL: TestAuthZResponsePlugin (0.00s)
                            authz_unix_test.go:295: listen unix authz-test-plugin.sock: bind: file name too long
                        time="2020-04-07T10:07:04Z" level=warning msg="Request body is larger than: '1048576' skipping body"

                        --- FAIL: TestMiddlewareWrapHandler (0.00s)
                            authz_unix_test.go:295: listen unix authz-test-plugin.sock: bind: file name too long
                        FAIL

                        FAIL	github.com/docker/docker/pkg/authorization	0.120s


                        This change moves the socket creation from a working test directory to a tmp directory,

                        so the path is shorter.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Roman Mazur <roman@balena.io>
                        signed-off-by: Roman Mazur <roman@balena.io>
                      author: Roman Mazur
                      nested: []
                    - subject: Move ci to balenaCI
                      hash: 9182c33542feb05ae46a66f2cfdeeefef6fa7333
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Connects-to: https://github.com/balena-io-modules/detectorist/pull/27
                        connects-to: https://github.com/balena-io-modules/detectorist/pull/27
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "contrib: Add balena-engine version of dind container"
                      hash: ef813f867206df9ae6f3ddf1cb5d3915f8718cc5
                      body: >
                        This modifies https://github.com/docker-library/docker
                        for balena-engine
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "build.sh: Disable btrfs,zfs,devicemapper graphdrivers"
                      hash: 88a5416e94945bc6998ba00723da26b738eb5bcd
                      body: >
                        We don't support these on balenaOS anyway and we are
                        planning to drop

                        support for them once we move to the new balenaCI-based pipeline.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "Bump CLI dependency to include fix for #178"
                      hash: de8d373699d5e45676a769f6ff5927e95df3dade
                      body: ""
                      footer:
                        Connects-to: https://github.com/balena-os/balena-engine/issues/178
                        connects-to: https://github.com/balena-os/balena-engine/issues/178
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Bump CLI dependency to include --cidenv flag
                      hash: bf7bfef7f8e8dee6dd7c17a81a69bc5ea891bec7
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Connects-to: https://github.com/balena-os/balena-engine-cli/pull/8
                        connects-to: https://github.com/balena-os/balena-engine-cli/pull/8
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Allow passing container ID to container via environment variable
                      hash: 635b48ca954c92ce7e35b2667c2001a52f43ef6d
                      body: >
                        This adds a new ContainerIDEnv field to HostConfig that
                        can pass an

                        environment variable name, which will be set to the container ID and

                        passed to the container environment.
                      footer:
                        Change-type: patch
                        change-type: patch
                        Connects-to: https://github.com/balena-os/balena-engine/issues/173
                        connects-to: https://github.com/balena-os/balena-engine/issues/173
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "contrib/install.sh: Add details to the success message"
                      hash: 876ea49bb8e948c97cd959fcb7413e84e33f7006
                      body: >
                        First warn the user that balena-engine-daemon needs to
                        be started.

                        Including instructions on how to make the system ready for that:

                        - service files

                        - balena-engine group

                        - how to allow non-root users to run containers
                      footer:
                        Connects-to: "#51"
                        connects-to: "#51"
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "contrib/install.sh: Rename balena to balenaEngine in ASCII art output"
                      hash: 4d922b5df74978275dab83e7564359c0dfe99797
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "contrib/install.sh: Fail on error"
                      hash: f93ce1f5226a882b0115cf321fc40e7d55f0e583
                      body: >
                        The install script should not print the success message
                        if it didn't

                        actually succeed to install anything
                      footer:
                        Connects-to: "#54"
                        connects-to: "#54"
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Add daemon flags to configure max download/upload attempts during
                        pull/push
                      hash: feaeb5dd826eeb0a95908dfd91704238a59e8257
                      body: >
                        The defaults remain the same (dl=5, ul=5), but are moved
                        from distribution/xfer to

                        daemon/config.
                      footer:
                        Connects-to: https://github.com/balena-os/balena-engine/issues/160
                        connects-to: https://github.com/balena-os/balena-engine/issues/160
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "aufs,overlay2: Add driver opts for disk sync"
                      hash: 4fed10dd3a66e37f0f128b2f9fa227a9a6800da2
                      body: >
                        This patch adds a driver option to enalble/disable the
                        to disk syncing introduced in

                        684d8ba6109c853b355bf11ca3733c4099f14b92.


                        The default is still to sync all currently mounted filesystems before

                        reporting an ApplyDiff as successful.
                      footer:
                        Connects-to: https://github.com/balena-os/balena-engine/issues/133
                        connects-to: https://github.com/balena-os/balena-engine/issues/133
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Fix double locking in the event handling code of OOM events
                      hash: d0bc0e5326438656f7d41a1f25ae621693777c2f
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "integration-tests: Add test for containers with memory,cpu
                        constraints"
                      hash: ff2ac4d6823dfc30c115499a5d6f908752ea9223
                      body: >
                        The only test from integration/ that covers any resource
                        constrained

                        container scenarios is the OomKilled check in integration/container/kill_test.go


                        This adds two addional checks that try to create, startk, stop and

                        inspect a busybox container with:

                        a) a memory constraint like: balena-engine run -m 32m ..

                        b) a memory constraint like: balena-engine run -cpus ".5" ..
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Update Dockerfiles used for build to Go 1.10.8
                      hash: fa51b5b458889c413f2ab82171e0f5fe3b3def5e
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "travis: Use the minimal machine"
                      hash: 1f6ab50f0cc20d21a5719e4a00f5407f231ed6f2
                      body: >
                        Since we build in docker anyway we can save the time it
                        usually takes to

                        set up the Go environment.

                        See https://docs.travis-ci.com/user/languages/minimal-and-generic/
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Add cli for tagging delta images
                      hash: 547a76a4924cf02e104fb31301f548a11c7bc4bb
                      body: >
                        Update vendor.conf and vendor/ to include
                        https://github.com/balena-os/balena-engine-cli/pull/7
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: Allow tagging of image deltas on creation
                      hash: 7f569a1e2407800e1c5f5d94f715c4313c5c4300
                      body: >
                        Similar to how the build command allows tagging of
                        images this allows

                        specifying a repo:tag indentifier to tag the delta with
                      footer:
                        Requires: https://github.com/balena-os/balena-engine-cli/pull/7
                        requires: https://github.com/balena-os/balena-engine-cli/pull/7
                        Change-type: minor
                        change-type: minor
                        Signed-off-by: Robert Gnzler <robertg@balena.io>
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                    - subject: "docs: Fix Docker capitalisation in balenaEngine docs"
                      hash: 06a6c66a5c69eed887d75030db211314449bb3d4
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Paulo Castro <paulo@balena.io>
                        signed-off-by: Paulo Castro <paulo@balena.io>
                      author: Paulo Castro
                      nested: []
                    - subject: Update balenaEngine logo in README.md
                      hash: fccd0f311c732a74bdc02b2d14254f1ff13ac4a0
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Paulo Castro <paulo@balena.io>
                        signed-off-by: Paulo Castro <paulo@balena.io>
                      author: Paulo Castro
                      nested: []
                    - subject: Disable incompatible integration tests
                      hash: 55bd77642535e56fa47d54d7cd1e86b318e17644
                      body: ""
                      footer:
                        Change-type: patch
                        change-type: patch
                        Signed-off-by: Paulo Castro <paulo@resin.io>
                        signed-off-by: Paulo Castro <paulo@resin.io>
                      author: Paulo Castro
                      nested: []
                  version: balena-engine-20.10.12
                  title: "'Update to moby v20.10.11'"
                  date: 2022-02-18T11:34:33.484Z
                - commits:
                    - subject: Merge upstream v20.10.11
                      hash: 8bd50366a9390750523562b3be8087c87e977fda
                      body: "For full changelog see:
                        https://github.com/balena-os/balena-engine/blob/20.10-b\
                        alena/CHANGELOG.md#2021-12-09-upstream-release"
                      footers:
                        change-type: major
                        signed-off-by: Robert Gnzler <robertg@balena.io>
                      author: Robert Gnzler
                      nested: []
                  version: balena-engine-20.10.11
                  date: 2021-12-09T12:00:00.000Z
          version: meta-balena-2.94.0
          title: "'balena-engine: Update to 20.10.12'"
          date: 2022-03-01T18:22:50.587Z
        - commits:
            - subject: "prepare-openvpn: Make configurable"
              hash: a475af4c69a7fafca28009286ddba7e4f3015ae4
              body: >
                The prepare-openvpn service needs to be restarted to regenerate
                the

                VPN keys when provisioning is finished and the `apiKey` is removed.


                Note that flasher images make changes to `/mnt/boottmp/config.json` so

                we still need to manually kick `prepare-openvpn` in

                `resin-device-register`, which is preferable to modifying services to

                watch multiple paths.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: meta-balena-2.93.2
          title: "'Make  restart on  change'"
          date: 2022-03-01T16:49:06.172Z
        - commits:
            - subject: "tests/cloud: Use deviceID returned from pre-registration"
              hash: 7fdddb9a886bef14442a89f4440528a513239645
              body: >
                Avoid additional wait and API call when we already have the
                device ID.


                This might also resolve a race condition that has been difficult to

                track down.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
          version: meta-balena-2.93.1
          title: "'tests/cloud: Use deviceID returned from pre-registration'"
          date: 2022-02-28T19:09:38.684Z
        - commits:
            - subject: "resin-device-register: Use supervisor version label instead of tag"
              hash: 8219b38be32cfa5b3674d7d96cf6b81b31e95328
              body: >
                This is just a name change that reflects the wider change that
                the

                supervisor is no longer fetched from dockerhub but from Balena's registry.
              footer:
                Change-type: minor
                change-type: minor
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "balena-supervisor: Rename repository/tag to fleet/version"
              hash: 2d284b2015e3d7f6c6a37a63ce49f6f89da7696d
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "docker-disk: entry.sh: Rename repository/tag to fleet/version"
              hash: c308fbc1f040a708d44fda20dc2e81d75b07b6d3
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: meta-balena-2.93.0
          title: "'Rename repository/tag to fleet/version'"
          date: 2022-02-26T15:34:40.619Z
        - commits:
            - subject: Update ModemManager to v1.18.4
              hash: ac680ef2005ae9c0f263e6fab7755bf29dc37977
              body: ""
              footer:
                Change-type: minor
                change-type: minor
                Changelog-entry: Update ModemManager to v1.18.4
                changelog-entry: Update ModemManager to v1.18.4
                Signed-off-by: Zahari Petkov <zahari@balena.io>
                signed-off-by: Zahari Petkov <zahari@balena.io>
              author: Zahari Petkov
              nested: []
          version: meta-balena-2.92.0
          title: "'modemmanager: Update to v1.18.4'"
          date: 2022-02-25T18:11:37.797Z
        - commits:
            - subject: "resin-device-register: Regenerate VPN credentials on registration"
              hash: e6ccbc74b35c900f99998599e61bf36795dd4419
              body: >
                Before registration the VPN credentials use the `apiKey`, once
                the

                device is registered we need to regenerate the credentials to use the

                `deviceApiKey` instead.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "resin-init-flasher: Wait for resin-device-register to start"
              hash: 314047e72cb133dcd531df2e7b8c632024f78694
              body: >
                Unless the device has been registered, provisioning reports are
                not

                sent to the fleet.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: meta-balena-2.91.6
          title: "'Improve provisioning'"
          date: 2022-02-25T09:14:39.101Z
        - commits:
            - subject: "suites/os: Add testcase for RPi device-tree"
              hash: 682d64ff8cd0290cd4788c332fbe021045299639
              body: |
                Upstream kernel added a new fkms overlay for
                the Pi4 and CM4 and switched to using it
                from overlay-map, however, we were not aware
                of this.

                Let's add a vcdbg testcase to warn in case the RPi
                firmware fails to load any overlay or dtb, and set
                gpu_mem to 64 so that vcdbg can run.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alexandru Costache <alexandru@balena.io>
                signed-off-by: Alexandru Costache <alexandru@balena.io>
              author: Alexandru Costache
              nested: []
          version: meta-balena-2.91.5
          title: "'suites/os: Add testcase for RPi device-tree'"
          date: 2022-02-24T22:45:17.483Z
        - commits:
            - subject: "openvpn: Remove dependency on timesync-http target"
              hash: 13cf7c9fef0a6e0df6b042ba34ceaa7a0d005254
              body: >
                We want the VPN to start unconditionally even if the
                connectivity URL

                is not reachable.


                The rationale for adding the dependency in the first place was that

                without an initial timesync certificate checks may fail. This can still

                happen, but the VPN will retry continuously and eventually succeed once

                the time is synched.


                What happens now is that the VPN is delayed until the http sync, so if

                the connectivity URL is blocked or unreachable, but the internet is

                accessible, VPN will not even launch and no remote debugging is possible.


                Fixes #2508
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: meta-balena-2.91.4
          title: "'openvpn: Remove dependency on timesync-http target'"
          date: 2022-02-24T20:29:51.915Z
        - commits:
            - subject: "tests/os: Wait for os-config-json service to be inactive"
              hash: 1a7eead77e63c72cc1418a0f87d6b540e7deaa80
              body: |
                Wait for os-config-json service to be inactive between tests
                so the next changes to config.json are not missed by systemd.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
          version: meta-balena-2.91.3
          title: "'tests/os: Wait for os-config-json service to be inactive'"
          date: 2022-02-24T17:56:40.238Z
        - commits:
            - subject: "contributing-device-support.md: Updates to board support instructions"
              hash: 47230867149db0a526a0dfdfa847e0eec9a3020b
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Florin Sarbu <florin@balena.io>
                signed-off-by: Florin Sarbu <florin@balena.io>
              author: Florin Sarbu
              nested: []
          version: meta-balena-2.91.2
          title: "'contributing-device-support.md: Updates to board support instructions'"
          date: 2022-02-23T14:52:43.399Z
    - subject: Update balena-yocto-scripts to v1.17.6
      hash: df8608605e95d882592ce28ba9e6443c451f2e54
      body: |
        Update balena-yocto-scripts from v1.17.2 to v1.17.6
      footer:
        Changelog-entry: Update balena-yocto-scripts to v1.17.6
        changelog-entry: Update balena-yocto-scripts to v1.17.6
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested:
        - commits:
            - subject: "barys: Remove RESINHUP setting"
              hash: 367f153009928f36de8edcd97a56d6f58b5d6773
              body: |
                This has now been removed from meta-balena.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: balena-yocto-scripts-1.17.6
          title: "'barys: Remove RESINHUP setting'"
          date: 2022-03-08T19:00:31.730Z
        - commits:
            - subject: "balena-deploy: Avoid patching test suites config.js during deploy"
              hash: 21c27cd41cda7ee7f5041752cca1f79280c51a7e
              body: >
                This will allow us to make changes to config.js in meta-balena
                without

                breaking the deploy steps. If additional changes are needed at runtime

                the substitutions can be made by the leviathan Jenkins job.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
          version: balena-yocto-scripts-1.17.5
          title: "'balena-deploy: Avoid patching test suites config.js during deploy'"
          date: 2022-03-08T13:38:17.771Z
        - commits:
            - subject: Init and update submodules when switching meta-balena branches
              hash: 5162e7c9fa39498488303caab7d746456fc9abd4
              body: >
                If the submodule was recently added to meta-balena, the checkout

                command will not initialize it without a separate submodule update

                command.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
          version: balena-yocto-scripts-1.17.4
          title: "'Init and update submodules when switching meta-balena branches'"
          date: 2022-03-03T16:46:17.542Z
        - commits:
            - subject: "jenkins_build: Use recurse-submodules when checking out meta-balena"
              hash: 00fb29b9a7a00dc1209be497ef171736e6229954
              body: >
                If meta-balena has submodule updates we want to make sure to use
                them.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
          version: balena-yocto-scripts-1.17.3
          title: "'jenkins_build: Use recurse-submodules when checking out meta-balena'"
          date: 2022-03-02T17:17:21.631Z
  version: 2.94.4
  title: "'Release v2.94.4'"
  date: 2022-03-10T12:45:28.421Z
- commits:
    - subject: Update meta-balena from v2.89.11 to v2.91.1
      hash: ec030374015be32f49a1f2dac3dacb4e64a20ad1
      body: |
        Update meta-balena from 2.89.11 to 2.91.1
      footer:
        Changelog-entry: Update meta-balena from v2.89.11 to v2.91.1
        changelog-entry: Update meta-balena from v2.89.11 to v2.91.1
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested:
        - commits:
            - subject: "tests/cloud: wait for update lock message in logs"
              hash: c50dd793f7409cb4b899e859478730ebe3c576e0
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
            - subject: "tests/cloud: register teardown before  online"
              hash: 2b6f8cc7b91472ebb612c60d56044cbc03af3ca8
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
          version: meta-balena-2.91.1
          title: "'fix journal log retrieval in cloud suite, and try to make override lock
            test consistant'"
          date: 2022-02-21T10:48:39.255Z
        - commits:
            - subject: "openssh: Add a dependency on os-sshkeys"
              hash: 0abc9213ba004325b77d96541e856aaf93cfdde2
              body: >
                This is required so that changes in the public keys are picked
                up

                by the SSH server.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "balena-supervisor: Add dependency on root CA"
              hash: 64cb45211a909b25170227079a400c2dfc9afae9
              body: >
                This is required so that the supervisor picks up a change in the
                root CA

                certificate.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "balena: Add dependency on balena-hostname"
              hash: b4d9569261de3a6640394ff416264f9e64c5367b
              body: >
                This is needed so that the hostname change is picked up by the
                container

                applications.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: Make services configurable
              hash: eb2028e5ed477ac4626bc55180cd872cd93f67b7
              body: >
                Changes to the system configuration will now restart several
                services.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "classes: Add balena-configurable"
              hash: 5b26f9200e8051859906016e84c03ab3d72a11d1
              body: >
                This class adds support to apply configuration changes to a
                systemd

                unit.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: "balena-config-vars: Split config.json configuration on write"
              hash: cd7dcc30dc58255d5c84c6e64142f4073797d557
              body: >
                When config.json is written, use the config.json unit
                configuration to create

                per-unit configuration files extracts.


                These will then be monitored by the respective service units to trigger

                restarts, so that service units will only be restarted when there are

                configuration changes that apply to them.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
            - subject: Remove config-json.target
              hash: 5e5de909b648d97ca949e7f6fed08ebbd6471893
              body: >
                Unit files that are configured via config.json and want to be
                restarted

                on config.json changes are part of this target.


                This causes a burst of service restarts each time config.json changes,

                independently of whether the configuration changes applies to the unit

                or not.


                This commit removes all config-json.target instances in preparation for

                the introduction of a better, more fine grained mechanism.
              footer:
                Change-type: minor
                change-type: minor
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: meta-balena-2.91.0
          title: "'Per-unit configuration files'"
          date: 2022-02-14T09:30:35.337Z
        - commits:
            - subject: "resin-init-flasher: check for UEFI mode and set config variables"
              hash: 102a710fbbcbbd347d801263a9b96e432ec5e7b9
              body: |
                Check to see whether we are running in UEFI mode and set secure
                boot configuration variables as appropriate.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Mark Corbin <mark@balena.io>
                signed-off-by: Mark Corbin <mark@balena.io>
              author: Mark Corbin
              nested: []
            - subject: "resin-init-flasher: Fix flashing progress reporting for LUKS"
              hash: 5c44a257073a993c81692e09eabba842f2aaca1a
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Michal Toman <michalt@balena.io>
                signed-off-by: Michal Toman <michalt@balena.io>
              author: Michal Toman
              nested: []
            - subject: "resin-init-flasher: Use flasher kernel to emulate stage2 bootloader
                with LUKS"
              hash: ebd9c9b775cb82247c1cd9b5ed4fe44864aa2343
              body: >
                In order to avoid the need to unlock encrypted partitions in
                GRUB we want

                to use a custom stage2 bootloader. Since that is not ready yet, emulate that

                by copying flasher kernel to the EFI partition, start it from GRUB, have it

                unlock all the partitions, find the real kernel and kexec into it.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Michal Toman <michalt@balena.io>
                signed-off-by: Michal Toman <michalt@balena.io>
              author: Michal Toman
              nested: []
            - subject: "resin-init-flasher: Add support for opt-in full disk encryption"
              hash: 857f44dc37ed28d2bfe285e0243a9894d7315ffe
              body: >
                If resin-init-flasher.conf has LUKS=1 flasher will:

                - Add extra 2MB to each partition for the LUKS header

                - Split resin-boot into EFI and linux boot

                - LUKS-format the partitions, copy image contents after unlocking

                - Propagate signatures for secure boot


                The default behavior (LUKS undefined) is unchanged
              footer:
                Change-Type: minor
                change-type: minor
                Signed-off-by: Michal Toman <michalt@balena.io>
                signed-off-by: Michal Toman <michalt@balena.io>
              author: Michal Toman
              nested: []
          version: meta-balena-2.90.0
          title: "'Update flasher for LUKS encryption'"
          date: 2022-02-13T18:21:21.805Z
        - commits:
            - subject: "README: Update versioning information"
              hash: 3ac5a5aaac1be6364a5ec8519b313b1da979b6a3
              body: >
                The `balena-<board>` repositories now use the same versioning
                scheme as

                application containers. This commit reflects this change in the

                documentation.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: meta-balena-2.89.19
          title: "'README: Update versioning information'"
          date: 2022-02-13T12:49:17.731Z
        - commits:
            - subject: fix cloud suite teardown
              hash: 6fd7cb7ac9b7612db859afe931c0c34f693d3521
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
          version: meta-balena-2.89.18
          title: "'fix cloud suite teardown'"
          date: 2022-02-11T20:46:38.043Z
        - commits:
            - subject: "suites/hup: Add under-voltage test before and after HUP"
              hash: e12de74e6cdcec2af488a8e5f8e0e14613ac1658
              body: |
                We add this this check since we discovered
                that with newer boot firmware the Pi4 will
                not reboot when under-voltage is reported.

                We don't mark the test as failed in
                this case, since there may be devices that
                continue to work even if under-powered and we
                don't want to block or delay development if the
                DUT is remote and cannot be checked or replaced
                easily.

                This check provides an indication for further
                debugging of failed test cases.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alexandru Costache <alexandru@balena.io>
                signed-off-by: Alexandru Costache <alexandru@balena.io>
              author: Alexandru Costache
              nested: []
          version: meta-balena-2.89.17
          title: "'[tests]: Add under-voltage check for OS and HUP suites'"
          date: 2022-02-09T16:48:41.543Z
        - commits:
            - subject: "balena-supervisor: Update balena-supervisor to v12.11.32"
              hash: d222a1f6c84ff98f7698efd671063a0eeebb3ae3
              body: >
                Includes improvements when writing to `config.json` to reduce
                the chances of corruption.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Felipe Lalanne <felipe@balena.io>
                signed-off-by: Felipe Lalanne <felipe@balena.io>
              author: Felipe Lalanne
              nested: []
          version: meta-balena-2.89.16
          title: "'balena-supervisor: Update balena-supervisor to v12.11.32'"
          date: 2022-02-07T15:27:34.945Z
        - commits:
            - subject: "resindataexpander: do not return after resizing the partition only"
              hash: dfb9a2e0b30ac5bbfef24332487ef537b6a830b1
              body: >
                After moving the partition resizing code to execute on each
                boot,

                we made it unreachable on first boot. We must not exit the script

                after resizing the partition only because that way the resizing

                is only finished on 2nd boot.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Michal Toman <michalt@balena.io>
                signed-off-by: Michal Toman <michalt@balena.io>
              author: Michal Toman
              nested: []
          version: meta-balena-2.89.15
          title: "'resindataexpander: do not return after resizing the partition only'"
          date: 2022-02-07T10:54:58.341Z
        - commits:
            - subject: "resin-u-boot.bbclass: Do not error if no config_defaults.h"
              hash: 74b297cd03bd6f6f8af9d4a9e60514770420a218
              body: |
                The header has been removed in upstream commit
                5c6a4d5a2779d7c2611319076d9aa4a23981855f
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Florin Sarbu <florin@balena.io>
                signed-off-by: Florin Sarbu <florin@balena.io>
              author: Florin Sarbu
              nested: []
          version: meta-balena-2.89.14
          title: "'resin-u-boot.bbclass: Do not error if no config_defaults.h'"
          date: 2022-02-03T17:15:47.568Z
        - commits:
            - subject: "docker-disk: Tag the supervisor digest with the repo name"
              hash: 52c2b0843bc19865fbe2298e508a9196c7143a2f
              body: >
                This will allow us to refer to the supervisor image by the repo
                name

                in docker commands, like docker inspect, and prevent re-downloading the

                image even though it already exists as an untagged digest.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
          version: meta-balena-2.89.13
          title: "docker-disk: Tag the supervisor digest with the repo name"
          date: 2022-02-01T21:39:09.997Z
        - commits:
            - subject: "resindataexpander: expand fs independent of partition"
              hash: 2889cb431e02f1f3e030f6c05a42be7374457eeb
              body: >
                When resizing the filesystem fails, such as when resize2fs won't
                touch

                it because it's dirty, the partition gets resized, but not the

                filesystem. The script will not attempt to resize the filesystem again,

                as it detects the partition has already been resized.


                Split these actions apart, so that the filesystem resize is always

                attempted. If resize2fs detects that the filesystem is already filling

                available space, it will exit with no action taken.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Joseph Kogut <joseph@balena.io>
                signed-off-by: Joseph Kogut <joseph@balena.io>
              author: Joseph Kogut
              nested: []
          version: meta-balena-2.89.12
          title: "resindataexpander: expand fs independent of partition"
          date: 2022-01-31T10:24:09.275Z
    - subject: Update balena-yocto-scripts to v1.17.2
      hash: 42d28430cccba231270f41558c90f6c213d34af8
      body: |
        Update balena-yocto-scripts from v1.17.1 to v1.17.2
      footer:
        Change-type: patch
        change-type: patch
        Changelog-entry: Update balena-yocto-scripts to v1.17.2
        changelog-entry: Update balena-yocto-scripts to v1.17.2
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested:
        - commits:
            - subject: "prepare-and-start: Remove balena login"
              hash: 67568d3a5eceb45ee65c245baae18fa299366f9e
              body: |
                The login will happen as needed.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Alex Gonzalez <alexg@balena.io>
                signed-off-by: Alex Gonzalez <alexg@balena.io>
              author: Alex Gonzalez
              nested: []
          version: balena-yocto-scripts-1.17.2
          title: "'prepare-and-start: Remove balena login'"
          date: 2022-02-25T09:19:00.323Z
  version: 2.91.1
  title: "'Release v2.91.1'"
  date: 2022-02-28T00:17:24.477Z
- commits:
    - subject: Update meta-balena from v2.89.8 to v2.89.11
      hash: 6ec6eb322a20d62bfaa07e8c21b3831fadd843e4
      body: |
        Update meta-balena from 2.89.8 to 2.89.11
      footer:
        Changelog-entry: Update meta-balena from v2.89.8 to v2.89.11
        changelog-entry: Update meta-balena from v2.89.8 to v2.89.11
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested:
        - commits:
            - subject: "image_types_balena: Augment dependency on u-boot do_deploy task"
              hash: e1782d968caa20e407386ba58bff3b1842006e9a
              body: >
                Some BSPs might only make use of UBOOT_MACHINE so let's consider

                this case in addition to UBOOT_CONFIG when setting dependency for

                u-boot's do_deploy task.
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Florin Sarbu <florin@balena.io>
                signed-off-by: Florin Sarbu <florin@balena.io>
              author: Florin Sarbu
              nested: []
          version: meta-balena-2.89.11
          title: "image_types_balena: Augment dependency on u-boot do_deploy task"
          date: 2022-01-29T08:06:09.408Z
        - commits:
            - subject: "tests: relax boot splash screen check"
              hash: 114b0f752f3b6c25e959ea193a501b5cd669fa7c
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
          version: meta-balena-2.89.10
          title: Ryan/boot splash improvement
          date: 2022-01-28T10:11:36.644Z
        - commits:
            - subject: archive logs using local ssh
              hash: 763fd146f042f60b4df5498d41e4dfe06dc931fe
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
            - subject: put archiver in the right place
              hash: 69234e0dff6dc1bd08bf70bd07d06d4c2b7d4edb
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
            - subject: Enable UART serial console for supported devices
              hash: 57733d47160d019452d8f9316a7728ac65bb9581
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Kyle Harding <kyle@balena.io>
                signed-off-by: Kyle Harding <kyle@balena.io>
              author: Kyle Harding
              nested: []
            - subject: archive image on teardown
              hash: 68cf636207c04a0a8f81e727edafda3bb53bfa31
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
            - subject: put device in dev mode
              hash: f1cd979692cd16dd93d8354230f5317bb78e76f8
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
            - subject: "tests: add extra logging to cloud suite"
              hash: 0f39876b55475b654cfed4b20dfda6243d21908f
              body: ""
              footer:
                Change-type: patch
                change-type: patch
                Signed-off-by: Ryan Cooke <ryan@balena.io>
                signed-off-by: Ryan Cooke <ryan@balena.io>
              author: rcooke-warwick
              nested: []
          version: meta-balena-2.89.9
          title: "tests: add extra logging to cloud suite"
          date: 2022-01-27T14:55:54.155Z
  version: 2.89.11
  title: "layers/meta-balena: Update to v2.89.11"
  date: 2022-02-01T13:25:38.331Z
- commits:
    - subject: Switch to kernel 5.15.11 supplied by the hardware vendor
      hash: 8b648448b7b03cdadf6e453550f294264e2ca803
      body: |
        This is the kernel version supplied by the hw vendor
        and it has both eth ports working.
      footer:
        Changelog-entry: Switch to kernel 5.15.11 supplied by the hardware vendor
        changelog-entry: Switch to kernel 5.15.11 supplied by the hardware vendor
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 2.89.8+rev3
  title: "nanopi-r2c: Switch to kernel 5.15.11"
  date: 2022-02-01T10:25:40.398Z
- commits:
    - subject: Delete from .coffee file the deprecated supportsBlink field
      hash: e940c4127dfbb0921ad9b01c38fd6528c4130ca7
      body: |
        This is now deprecated in favour of the hw contracts
      footer:
        Changelog-entry: Delete from .coffee file the deprecated supportsBlink field
        changelog-entry: Delete from .coffee file the deprecated supportsBlink field
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 2.89.8+rev2
  title: "nanopi-r2c.coffee: Delete deprecated supportsBlink field"
  date: 2022-01-30T13:26:16.566Z
- commits:
    - subject: Do not use sstate for compiling u-boot
      hash: 5a4f1b6f34427c610ec5f388a8d0addadcf6796d
      body: |
        We need to not use sstate because we have to be
        sure we always have the boot images available
        in the deploy directory.
      footer:
        Changelog-entry: Do not use sstate for compiling u-boot
        changelog-entry: Do not use sstate for compiling u-boot
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 2.89.8+rev1
  title: "u-boot: Force to always run the compile task"
  date: 2022-01-30T12:57:44.390Z
- commits:
    - subject: Add initial support for nanopi-r2c
      hash: 2b8564564339c5c8ad856c0eb9d35571255bde4e
      body: ""
      footer:
        Changelog-entry: Add initial support for nanopi-r2c
        changelog-entry: Add initial support for nanopi-r2c
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 2.89.8
  title: "nanopi-r2c: Initial support for this board"
  date: 2022-01-29T00:01:13.913Z
